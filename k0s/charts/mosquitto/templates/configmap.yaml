apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-config
data:
  mosquitto.conf: |
    # Mosquitto configuration file
    persistence true
    persistence_location /mosquitto/data/

    # MQTT listener
    listener {{ .Values.mqtt.port }}
    protocol mqtt

    # WebSocket listener
    listener {{ .Values.websocket.port }}
    protocol websockets

    # Authentication (allow anonymous for now)
    allow_anonymous true

    # Logging
    log_dest stdout
    log_type all
