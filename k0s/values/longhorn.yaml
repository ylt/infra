# Longhorn distributed block storage

defaultSettings:
  # 2 replicas for 2 worker nodes
  defaultReplicaCount: 2
  # Allow system components on Hyper-V and disk-pressure nodes
  taintToleration: "node-type=hyperv:NoSchedule;node.kubernetes.io/disk-pressure:NoSchedule"

# Tolerate Hyper-V and disk-pressure taints
longhornManager:
  tolerations:
    - key: node-type
      operator: Equal
      value: hyperv
      effect: NoSchedule
    - key: node.kubernetes.io/disk-pressure
      operator: Exists
      effect: NoSchedule

longhornDriver:
  tolerations:
    - key: node-type
      operator: Equal
      value: hyperv
      effect: NoSchedule
    - key: node.kubernetes.io/disk-pressure
      operator: Exists
      effect: NoSchedule

# Ingress for Longhorn UI (with Authentik forward auth)
ingress:
  enabled: true
  ingressClassName: traefik
  host: longhorn.golden.wales
  tls: true
  annotations:
    traefik.ingress.kubernetes.io/router.middlewares: traefik-authentik@kubernetescrd

persistence:
  defaultClass: true
  defaultClassReplicaCount: 2
